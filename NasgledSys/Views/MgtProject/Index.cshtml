@using NasgledSys.Models;
@{
    ViewBag.Title = "Project";
    Layout = "~/Views/Shared/_UserLayout.cshtml";
}

  


<link href="~/Content/datatables/dataTables.bootstrap.css" rel="stylesheet" />
<script src="~/Content/datatables/jquery.dataTables.js"></script>
<script src="~/Content/datatables/dataTables.bootstrap.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {

            GetAllCompanyName();
        });
      
        var CityListVM;
        $(function () {

            CityListVM = {
                dt: null,

                init: function () {
                    dt = $('#proj').DataTable({
                        "serverSide": true,
                        "processing": true,
                        "iDisplayLength": 10,
                        "iDisplayStart": 0,
                        "ajax": {
                            "url": "@Url.Action("GetProjectListData", "Home")",
                            "data": function (data) {

                                data.ProjectKey = $("#ProjectKey").val();
                                data.ProjectName = $("#ProjectName").val();
                                data.CompanyName = $("#CompanyName").val();
                                data.AdminName = $("#AdminName").val();
                                data.AreaNum = $("#AreaNum").val();
                                data.ExsistingProduct = $("#ExsistingProduct").val();
                            }
                        },
                        "columns": [

                            { "title": "Project Name", "data": "ProjectName", "searchable": true, "sortable": true },
                            { "title": "Company", "data": "CompanyName", "searchable": true, "sortable": false },
                             { "title": "Admin", "data": "AdminName", "searchable": false, "sortable": false },
                              { "title": "Areas", "data": "AreaNum", "searchable": false, "sortable": false },
                               { "title": "Exsisting Product", "data": "ExsistingProduct", "searchable": false, "sortable": false },
                            {
                                "title": "Actions",
                                "data": "ProjectKey",
                                "searchable": false,
                                "sortable": false,
                                "render": function (data, type, full, meta) {
                                    return '<a href="@Url.Action("Create", "MgtProject")?id=' + data + '" class="editCity">Edit</a>';
                                }
                            }
                        ],
                        "lengthMenu": [[10, 25, 50, 100], [10, 25, 50, 100]],
                    });
                },

                refresh: function () {
                    dt.ajax.reload();
                }
            }
            $('#btnPerformAdvancedSearch').on("click", CityListVM.refresh);          

            // initialize the datatables
            CityListVM.init();


        });
        function GetAllCompanyName() {
            $.ajax({
                traditional: true,
                type: "post",
                dataType: "json",
                contentType: "application/json",
                url: "/MgtClientCompany/GetClientCompanyListData/",
                success: function (data) {
                    baseList = data;
                    filteredList = data;
                    remakeGridCompany();
                },
                error: function (xhr, textStatus, errorThrown) {
                    console.log("Error on ajax call");
                }
            });
        }
        function remakeGridCompany() {
            var res = "";
            res = res + "<a href='/Home/Userhome' class='btn bg-blue-300 btn-block' type='button'><span>Select All</span></a>";



            for (var i = 0; i < filteredList.length; i++) {
                res = res
                    + "<a href='/Home/ProjectByCompany?id=" + filteredList[i].ClientCompanyKey + "' class='btn bg-purple-300 btn-block btn-float' type='button'><i class='icon-bag'></i><span>" + filteredList[i].CompanyName + "</span></a>";
            }

            $("#comp").html(res);
        }
   



    </script>


@section SideBar{
  <ul class="breadcrumb breadcrumb-caret position-right">
    <li><a href="@Url.Action("Userhome","Home")">Home</a></li>
    <li class="active">My Projects</li>
</ul>
}

@section CenterTitle{
    List View Of All Projects
}
@section TopHeader{
    <a href="/MgtProject/SelectCompany" class="btn bg-blue btn-labeled heading-btn"><b><i class="icon-task"></i></b> Add New Project</a>

}
<div class="sidebar sidebar-secondary sidebar-default">
    <div class="sidebar-content">
        <!-- Search task -->
        <div class="sidebar-category">
            <div class="category-title">
                <span>Search Project</span>
                <ul class="icons-list">
                    <li><a href="#" data-action="collapse"></a></li>
                </ul>
            </div>
            <div class="category-content">

                <div class="has-feedback has-feedback-left">
                    <input id="searchText" type="search" class="form-control" placeholder="Search for Project" onkeyup="search()" />
                    <div class="form-control-feedback">
                        <i class="icon-search4 text-size-base text-muted"></i>
                    </div>
                </div>

            </div>
        </div>
        <!-- /search task -->
        <!-- Action buttons -->
        <div class="sidebar-category">
            <div class="category-title">
                <span>Company</span>
                <ul class="icons-list">
                    <li><a href="#" data-action="collapse"></a></li>
                </ul>
            </div>
            <div class="category-content">
                <div class="row">
                    <div class="col-md-12" id="comp">

                    </div>


                </div>
            </div>
        </div>
        <!-- /action buttons -->
        <!-- Task navigation -->
        <div class="sidebar-category">
            <div class="category-title">
                <span>Navigation</span>
                <ul class="icons-list">
                    <li><a href="#" data-action="collapse"></a></li>
                </ul>
            </div>
            <div class="category-content no-padding">
                <ul class="navigation navigation-alt navigation-accordion">
                    <li class="navigation-header">Actions</li>

                    <li><a href="@Url.Action("Index","MgtClientContact")"><i class="icon-user-plus"></i> Contacts</a></li>
                    <li><a href="@Url.Action("IndexClientCompany","MgtClientCompany")"><i class="icon-collaboration"></i> Company</a></li>
                    <li class="navigation-header">Tasks</li>
                    <li><a href="@Url.Action("Index","UserItemCategory")"><i class="icon-files-empty"></i> Item Category</a></li>
                    <li><a href="@Url.Action("Index","UserItemSubcategory")"><i class="icon-file-plus"></i> Item Subcategory</a></li>
                    <li><a href="@Url.Action("Index","UserItemCatelogue")"><i class="icon-file-check"></i> Item Catelogue</a></li>
                    <li class="navigation-divider"></li>

                    <li><a href="@Url.Action("UserLogin","Home")"><i class="icon-cog3"></i> Logout</a></li>
                </ul>
            </div>
        </div>
        <!-- /task navigation -->


    </div>
</div>
<div class="content-wrapper">



        <table class="table table-striped table-bordered" id="proj"></table>

 
</div>


